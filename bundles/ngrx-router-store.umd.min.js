!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@ngrx/store"),require("@angular/core"),require("@angular/router"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@ngrx/router-store",["exports","@ngrx/store","@angular/core","@angular/router","rxjs/operators"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).ngrx=t.ngrx||{},t.ngrx["router-store"]={}),t.ngrx.store,t.ng.core,t.ng.router,t.rxjs.operators)}(this,(function(t,e,r,o,i){"use strict";var n="@ngrx/router-store/request",a=e.createAction(n,e.props()),u="@ngrx/router-store/navigation",s=e.createAction(u,e.props()),c="@ngrx/router-store/cancel",l=e.createAction(c,e.props()),p="@ngrx/router-store/error",f=e.createAction(p,e.props()),g="@ngrx/router-store/navigated",h=e.createAction(g,e.props());Object.create;function d(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,i,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)a.push(o.value)}catch(t){i={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return a}Object.create;var v,R=function(){},y=function(){function t(){}return t.prototype.serialize=function(t){return{root:this.serializeRoute(t.root),url:t.url}},t.prototype.serializeRoute=function(t){var e=this,r=t.children.map((function(t){return e.serializeRoute(t)}));return{params:t.params,paramMap:t.paramMap,data:t.data,url:t.url,outlet:t.outlet,routeConfig:t.routeConfig?{component:t.routeConfig.component,path:t.routeConfig.path,pathMatch:t.routeConfig.pathMatch,redirectTo:t.routeConfig.redirectTo,outlet:t.routeConfig.outlet}:null,queryParams:t.queryParams,queryParamMap:t.queryParamMap,fragment:t.fragment,component:t.routeConfig?t.routeConfig.component:void 0,root:void 0,parent:void 0,firstChild:r[0],pathFromRoot:void 0,children:r}},t}(),S=function(){function t(){}return t.prototype.serialize=function(t){return{root:this.serializeRoute(t.root),url:t.url}},t.prototype.serializeRoute=function(t){var e=this,r=t.children.map((function(t){return e.serializeRoute(t)}));return{params:t.params,data:t.data,url:t.url,outlet:t.outlet,routeConfig:t.routeConfig?{path:t.routeConfig.path,pathMatch:t.routeConfig.pathMatch,redirectTo:t.routeConfig.redirectTo,outlet:t.routeConfig.outlet}:null,queryParams:t.queryParams,fragment:t.fragment,firstChild:r[0],children:r}},t}();t.NavigationActionTiming=void 0,(v=t.NavigationActionTiming||(t.NavigationActionTiming={}))[v.PreActivation=1]="PreActivation",v[v.PostActivation=2]="PostActivation";var m,E=new r.InjectionToken("@ngrx/router-store Internal Configuration"),A=new r.InjectionToken("@ngrx/router-store Configuration"),N="router";function T(e){return Object.assign({stateKey:N,serializer:S,navigationActionTiming:t.NavigationActionTiming.PreActivation},e)}!function(t){t[t.NONE=1]="NONE",t[t.ROUTER=2]="ROUTER",t[t.STORE=3]="STORE"}(m||(m={}));var C=function(){function r(t,e,r,o,i){this.store=t,this.router=e,this.serializer=r,this.errorHandler=o,this.config=i,this.lastEvent=null,this.routerState=null,this.trigger=m.NONE,this.stateKey=this.config.stateKey,this.setUpStoreStateListener(),this.setUpRouterEventsListener()}return r.forRoot=function(t){return void 0===t&&(t={}),{ngModule:r,providers:[{provide:E,useValue:t},{provide:A,useFactory:T,deps:[E]},{provide:R,useClass:t.serializer?t.serializer:0===t.routerState?y:S}]}},r.prototype.setUpStoreStateListener=function(){var t=this;this.store.pipe(e.select(this.stateKey),i.withLatestFrom(this.store)).subscribe((function(e){var r=d(e,2),o=r[0],i=r[1];t.navigateIfNeeded(o,i)}))},r.prototype.navigateIfNeeded=function(t,e){var r=this;if(t&&t.state&&this.trigger!==m.ROUTER&&!(this.lastEvent instanceof o.NavigationStart)){var i,n,a=t.state.url;i=this.router.url,n=a,O(i)!==O(n)&&(this.storeState=e,this.trigger=m.STORE,this.router.navigateByUrl(a).catch((function(t){r.errorHandler.handleError(t)})))}},r.prototype.setUpRouterEventsListener=function(){var e,r=this,n=this.config.navigationActionTiming===t.NavigationActionTiming.PostActivation;this.router.events.pipe(i.withLatestFrom(this.store)).subscribe((function(t){var i=d(t,2),a=i[0],u=i[1];r.lastEvent=a,a instanceof o.NavigationStart?(r.routerState=r.serializer.serialize(r.router.routerState.snapshot),r.trigger!==m.STORE&&(r.storeState=u,r.dispatchRouterRequest(a))):a instanceof o.RoutesRecognized?(e=a,n||r.trigger===m.STORE||r.dispatchRouterNavigation(a)):a instanceof o.NavigationCancel?(r.dispatchRouterCancel(a),r.reset()):a instanceof o.NavigationError?(r.dispatchRouterError(a),r.reset()):a instanceof o.NavigationEnd&&(r.trigger!==m.STORE&&(n&&r.dispatchRouterNavigation(e),r.dispatchRouterNavigated(a)),r.reset())}))},r.prototype.dispatchRouterRequest=function(t){this.dispatchRouterAction(n,{event:t})},r.prototype.dispatchRouterNavigation=function(t){var e=this.serializer.serialize(t.state);this.dispatchRouterAction(u,{routerState:e,event:new o.RoutesRecognized(t.id,t.url,t.urlAfterRedirects,e)})},r.prototype.dispatchRouterCancel=function(t){this.dispatchRouterAction(c,{storeState:this.storeState,event:t})},r.prototype.dispatchRouterError=function(t){this.dispatchRouterAction(p,{storeState:this.storeState,event:new o.NavigationError(t.id,t.url,""+t)})},r.prototype.dispatchRouterNavigated=function(t){var e=this.serializer.serialize(this.router.routerState.snapshot);this.dispatchRouterAction(g,{event:t,routerState:e})},r.prototype.dispatchRouterAction=function(t,e){this.trigger=m.ROUTER;try{this.store.dispatch({type:t,payload:Object.assign(Object.assign({routerState:this.routerState},e),{event:0===this.config.routerState?e.event:{id:e.event.id,url:e.event.url,urlAfterRedirects:e.event.urlAfterRedirects}})})}finally{this.trigger=m.NONE}},r.prototype.reset=function(){this.trigger=m.NONE,this.storeState=null,this.routerState=null},r}();function O(t){return t.length>0&&"/"===t[t.length-1]?t.substring(0,t.length-1):t}C.decorators=[{type:r.NgModule,args:[{}]}],C.ctorParameters=function(){return[{type:e.Store},{type:o.Router},{type:R},{type:r.ErrorHandler},{type:void 0,decorators:[{type:r.Inject,args:[A]}]}]},t.DEFAULT_ROUTER_FEATURENAME=N,t.DefaultRouterStateSerializer=y,t.MinimalRouterStateSerializer=S,t.ROUTER_CANCEL=c,t.ROUTER_CONFIG=A,t.ROUTER_ERROR=p,t.ROUTER_NAVIGATED=g,t.ROUTER_NAVIGATION=u,t.ROUTER_REQUEST=n,t.RouterStateSerializer=R,t.StoreRouterConnectingModule=C,t.getSelectors=function(t){var r=e.createSelector(t,(function(t){return t&&t.state})),o=e.createSelector(r,(function(t){return t&&t.root})),i=e.createSelector(o,(function(t){if(t){for(var e=t;e.firstChild;)e=e.firstChild;return e}})),n=e.createSelector(o,(function(t){return t&&t.fragment})),a=e.createSelector(o,(function(t){return t&&t.queryParams})),u=e.createSelector(i,(function(t){return t&&t.params})),s=e.createSelector(i,(function(t){return t&&t.data})),c=e.createSelector(r,(function(t){return t&&t.url}));return{selectCurrentRoute:i,selectFragment:n,selectQueryParams:a,selectQueryParam:function(t){return e.createSelector(a,(function(e){return e&&e[t]}))},selectRouteParams:u,selectRouteParam:function(t){return e.createSelector(u,(function(e){return e&&e[t]}))},selectRouteData:s,selectUrl:c}},t.routerCancelAction=l,t.routerErrorAction=f,t.routerNavigatedAction=h,t.routerNavigationAction=s,t.routerReducer=function(t,e){var r=e;switch(r.type){case u:case p:case c:return{state:r.payload.routerState,navigationId:r.payload.event.id};default:return t}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */,t.routerRequestAction=a,t.ɵa=E,t.ɵb=T,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngrx-router-store.umd.min.js.map